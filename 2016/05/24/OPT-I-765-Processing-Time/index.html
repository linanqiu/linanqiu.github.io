<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>OPT I-765 Processing Time | Pandamonium</title>
  <meta name="description" content="Musings of a Panda" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />

  <meta name="generator" content="Pandamonium">

  
  
  

  
</head>


<body class="post-template">

  <header class="site-head" >
    <div class="vertical">
        <div class="site-head-content inner">
            
            <h1 class="blog-title"><a href="/">Pandamonium</a></h1>
            <h2 class="blog-description"><a href="/">Musings of a Panda</a></h2>
        </div>
    </div>
</header>

  

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2016-05-24T18:51:45.000Z" itemprop="datePublished">
          2016-05-24
      </time>
    
    
    | 
    <a href='/tags/data/'>data</a>,
    
    <a href='/tags/opt/'>opt</a>,
    
    <a href='/tags/uscis/'>uscis</a>,
    
    <a href='/tags/scraping/'>scraping</a>
    
    
</span>
    <h1 class="post-title">OPT I-765 Processing Time</h1>
    <section class="post-content">
      <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.style.use(<span class="string">'ggplot'</span>)</span><br><span class="line">%config InlineBackend.figure_format = <span class="string">'svg'</span></span><br></pre></td></tr></table></figure>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>Students under the F-1 visa usually apply for Optional Practical Training (OPT) to get work authorization from US Citizenship and Immigration Services (USCIS) for internships / jobs. It is also the ultimate test of one’s patience. Even after one has braved the inane paperworks and countless trips to advisors / international student offices, one would still have to wait up to 90 days for the authorization approval. <strong>What makes this wait worse is the lack of updates during the wait.</strong> When one applies for OPT (and the application is received by USCIS), one gets a receipt number. Using this receipt number to check one’s progress (at <a href="https://egov.uscis.gov/casestatus/mycasestatus.do" target="_blank" rel="external">https://egov.uscis.gov/casestatus/mycasestatus.do</a>) is highly unsatisfying. Until the work authorization is approved (or God forbid rejected / put on hold for additional evidence), one is faced with rather useless description that reads something like this:</p>
<blockquote>
<p>‘On February 22, 2016, we received your Form I-765, Application for Employment Authorization , Receipt Number EAC1690120079, and sent you the receipt notice that describes how we will process your case. Please follow the instructions in the notice. If you do not receive your receipt notice by March 23, 2016, please call Customer Service at 1-800-375-5283. If you move, go to www.uscis.gov/addresschange to give us your new mailing address.’</p>
</blockquote>
<p>USCIS does a really bad job of keeping one updated on the progress of a case and in general how far along they are going with the entire year’s batch of students.</p>
<p><strong>Fortunately, we can do better.</strong></p>
<h1 id="Receipt-Numbers"><a href="#Receipt-Numbers" class="headerlink" title="Receipt Numbers"></a>Receipt Numbers</h1><p>USCIS issues receipt numbers in chronological order. That means if I submitted my application on March 1, 2016 and I got the number YSC1690079958, the next person to submit his application gets the number YSC169007995<strong>9</strong>. The person before me gets the number YSC169007995<strong>7</strong>. Using this fact, I can see how people before and after me are doing. USCIS also states that the cases are processed in a first-come-first-serve order.</p>
<ul>
<li>If a huge proportion of people before (and possibly after) me have their OPTs approved, I should have mine processed soon.</li>
<li>However, if the people who submitted around my date are stil waiting for their approval, I can expect to wait a long time.</li>
</ul>
<p>However, doing so manually at [<a href="https://egov.uscis.gov/casestatus/mycasestatus.do(https://egov.uscis.gov/casestatus/mycasestatus.do" target="_blank" rel="external">https://egov.uscis.gov/casestatus/mycasestatus.do(https://egov.uscis.gov/casestatus/mycasestatus.do</a>) is a slow and tiring process. Instead, I can write a script to “scrape” the website for the 50,000 or so cases before and after my own number.</p>
<blockquote>
<p>Additional note: This year, there are two USCIS centers processing OPT applications – the Vermont office and the Potomac office. The Potomac office opened later in the cycle (around March) to help with the application volume. <a href="https://www.uscis.gov/news/potomac-service-center-now-processing-certain-form-i-765-cases" target="_blank" rel="external">https://www.uscis.gov/news/potomac-service-center-now-processing-certain-form-i-765-cases</a>. Applications that are sent to the Vermont office first have the prefix <code>EAC</code>. Those may be then routed to the Potomac office. Applications that are sent in late March and later are sent directly to the Potomac office, giving them the prefix <code>YSC</code>. This means that when I scrape the pages for data, I have to account for both prefixes.</p>
</blockquote>
<p>I planned to scrape receipt numbers <code>EAC1690120000</code> to <code>EAC1690180000</code> and <code>YSC1690040000</code> to <code>YSC1690080000</code>. This should give me a good sense of applications submitted in the February to April period.</p>
<h1 id="Scraping"><a href="#Scraping" class="headerlink" title="Scraping"></a>Scraping</h1><h2 id="IP-Blocking"><a href="#IP-Blocking" class="headerlink" title="IP Blocking"></a>IP Blocking</h2><p>I first wrote a simple <code>Node.JS</code> script to do this. I didn’t use <code>python</code> because <code>async</code> in <code>python</code> is a pain in the ass.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</span><br><span class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">'request'</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">async</span> = <span class="built_in">require</span>(<span class="string">'async'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> stringify = <span class="built_in">require</span>(<span class="string">'csv-stringify'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> URL = <span class="string">'https://egov.uscis.gov/casestatus/mycasestatus.do?appReceiptNum=RECEIPT_NUM'</span>;</span><br><span class="line"><span class="keyword">var</span> PREFIX = <span class="string">'EAC'</span>;</span><br><span class="line"><span class="keyword">var</span> START_NUMBER = <span class="number">1690120000</span>;</span><br><span class="line"><span class="keyword">var</span> END_NUMBER = <span class="number">1690180000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> receiptNumbers = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = START_NUMBER; i &lt; END_NUMBER; i++) &#123;</span><br><span class="line">  receiptNumbers.push(PREFIX + i);</span><br><span class="line">&#125;</span><br><span class="line">fs.writeFileSync(<span class="string">'raw_data.csv'</span>, <span class="string">'receipt,title,text\n'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">retrieveReceiptNumber</span>(<span class="params">receiptNumber, callback</span>) </span>&#123;</span><br><span class="line">  request(&#123;</span><br><span class="line">      url: URL.replace(<span class="string">'RECEIPT_NUM'</span>, receiptNumber),</span><br><span class="line">      rejectUnauthorized: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">err, resp, body</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> $ = cheerio.load(body);</span><br><span class="line">      <span class="keyword">var</span> title = $(<span class="string">'.appointment-sec'</span>).find(<span class="string">'.text-center'</span>).find(<span class="string">'h1'</span>).text();</span><br><span class="line">      <span class="keyword">var</span> description = $(<span class="string">'.appointment-sec'</span>).find(<span class="string">'.text-center'</span>).find(<span class="string">'p'</span>).text();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> violation = $(<span class="string">'label[for=accessviolation]'</span>).text();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (title.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (violation.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'access violation'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        callback();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> row = [</span><br><span class="line">          [receiptNumber, title, description]</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        stringify(row, <span class="function"><span class="keyword">function</span> (<span class="params">err, output</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="built_in">console</span>.error(err);</span><br><span class="line">          &#125;</span><br><span class="line">          fs.appendFile(<span class="string">'raw_data.csv'</span>, output, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">              <span class="built_in">console</span>.error(err);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">console</span>.log(receiptNumber + <span class="string">' written'</span>);</span><br><span class="line">            callback();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span>.eachLimit(receiptNumbers, <span class="number">100</span>, retrieveReceiptNumber, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'DONE'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Scrapoxy"><a href="#Scrapoxy" class="headerlink" title="Scrapoxy"></a>Scrapoxy</h2><p>USCIS (unsurprisingly) blocked my IP after around 2,000 queries. So I needed a way to get around the IP blocking. Fortunately, an easy solution was available: <a href="http://scrapoxy.io/" target="_blank" rel="external">http://scrapoxy.io/</a>. Scrapoxy manages a pool of EC2 / DigitalOcean instances for you (afte some setting up) and provides a single local port for you as a proxy. This allows you to route your requests through the multiple cloud instances. This lowers the likelihood of a single IP getting blocked. (Even if one gets blocked, you can simply kill the instance and restart it. I didn’t have to do this, sine none of the cloud instances got blocked). After setting up Scrapoxy and running the proxy at <code>http://localhost:8888</code>, I can pass this easily to the <code>request</code> module in my script:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</span><br><span class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">'request'</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">async</span> = <span class="built_in">require</span>(<span class="string">'async'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> stringify = <span class="built_in">require</span>(<span class="string">'csv-stringify'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> URL = <span class="string">'https://egov.uscis.gov/casestatus/mycasestatus.do?appReceiptNum=RECEIPT_NUM'</span>;</span><br><span class="line"><span class="keyword">var</span> PREFIX = <span class="string">'EAC'</span>;</span><br><span class="line"><span class="keyword">var</span> START_NUMBER = <span class="number">1690149000</span>;</span><br><span class="line"><span class="keyword">var</span> END_NUMBER = <span class="number">1690180000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> receiptNumbers = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = START_NUMBER; i &lt; END_NUMBER; i++) &#123;</span><br><span class="line">  receiptNumbers.push(PREFIX + i);</span><br><span class="line">&#125;</span><br><span class="line">fs.writeFileSync(<span class="string">'raw_data.csv'</span>, <span class="string">'receipt,title,text\n'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">retrieveReceiptNumber</span>(<span class="params">receiptNumber, callback</span>) </span>&#123;</span><br><span class="line">  request(&#123;</span><br><span class="line">      url: URL.replace(<span class="string">'RECEIPT_NUM'</span>, receiptNumber),</span><br><span class="line">      rejectUnauthorized: <span class="literal">false</span>,</span><br><span class="line">      proxy: <span class="string">'http://localhost:8888'</span>,</span><br><span class="line">      tunnel: <span class="literal">false</span> <span class="comment">// remember to set tunnel to false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">err, resp, body</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> $ = cheerio.load(body);</span><br><span class="line">      <span class="keyword">var</span> title = $(<span class="string">'.appointment-sec'</span>).find(<span class="string">'.text-center'</span>).find(<span class="string">'h1'</span>).text();</span><br><span class="line">      <span class="keyword">var</span> description = $(<span class="string">'.appointment-sec'</span>).find(<span class="string">'.text-center'</span>).find(<span class="string">'p'</span>).text();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> violation = $(<span class="string">'label[for=accessviolation]'</span>).text();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (title.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (violation.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">'access violation'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        callback();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> row = [</span><br><span class="line">          [receiptNumber, title, description]</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        stringify(row, <span class="function"><span class="keyword">function</span> (<span class="params">err, output</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="built_in">console</span>.error(err);</span><br><span class="line">          &#125;</span><br><span class="line">          fs.appendFile(<span class="string">'raw_data.csv'</span>, output, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">              <span class="built_in">console</span>.error(err);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">console</span>.log(receiptNumber + <span class="string">' written'</span>);</span><br><span class="line">            callback();</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span>.eachLimit(receiptNumbers, <span class="number">100</span>, retrieveReceiptNumber, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'DONE'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>The changes are in the options object passed to <code>request</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  url: URL.replace(<span class="string">'RECEIPT_NUM'</span>, receiptNumber),</span><br><span class="line">  rejectUnauthorized: <span class="literal">false</span>,</span><br><span class="line">  proxy: <span class="string">'http://localhost:8888'</span>,</span><br><span class="line">  tunnel: <span class="literal">false</span> <span class="comment">// remember to set tunnel to false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This allows me to scrape the receipt numbers very quickly within the hour. (see the <code>eachLimit</code> for <code>async</code>? I’m making 100 requests at any time through the proxy). I collected the scraped results into <code>raw_data_eac.csv</code> and <code>raw_data_ysc.csv</code> for the two prefixes.</p>
<p>Now let’s analyze them.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> pandas</span><br></pre></td></tr></table></figure>
<h1 id="Parsing-Data"><a href="#Parsing-Data" class="headerlink" title="Parsing Data"></a>Parsing Data</h1><p>Earlier, I only scraped the raw data from the pages. Hence, I only have the <code>receipt</code> (receipt number), <code>title</code> (the short line of text displayed at the top of each case status) and <code>text</code> (the full text of the case status). This is hardly useful.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data_eac = pandas.read_csv(<span class="string">'raw_data_eac.csv'</span>)</span><br><span class="line">data_ysc = pandas.read_csv(<span class="string">'raw_data_ysc.csv'</span>)</span><br><span class="line">data = data_eac.append(data_ysc)</span><br></pre></td></tr></table></figure>
<p>I can use this information to create a <code>status</code> for each receipt number. I’m using a lot of simplifying assupmtions here and disregarding a lot of corner cases (USCIS sometimes requests additional evidence, does weird thing with cases etc.) In fact, let’s take a look at the vaious case <code>title</code>s:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(data.groupby(<span class="string">'title'</span>).count()[<span class="string">'receipt'</span>])</span><br></pre></td></tr></table></figure>
<pre><code>title
Amended Notice Was Mailed                                                             8
Appeal Was Dismissed                                                                  9
Card Is Being Returned to USCIS by Post Office                                       10
Card Returned Undeliverable                                                           4
Card Was Delivered To Me By The Post Office                                       11434
Card Was Determined As Undeliverable By The Post Office                              26
Card Was Mailed To Me                                                              2045
Card Was Picked Up By The United States Postal Service                              162
Card Was Received By USCIS Along With My Letter                                       4
Card Was Returned And USCIS Is Holding It For One Year                               20
Card Was Returned To USCIS By Post Office                                             7
Case Is Pending at a Local Office                                                   449
Case Rejected Because I Sent An Incorrect Fee                                      1942
Case Rejected Because The Version Of The Form I Sent Is No Longer Accepted           64
Case Rejected For Form Not Signed And Incorrect Form Version                         38
Case Rejected For Incorrect Fee And Form Not Signed                                  94
Case Rejected For Incorrect Fee, Payment Not Signed And Incorrect Form Version       10
Case Terminated Benefit Received By Other Means                                      35
Case Transferred And New Office Has Jurisdiction                                      1
Case Transferred To Another Office                                                 1068
Case Was Approved                                                                  4558
Case Was Received                                                                 63510
Case Was Received At My Local Office                                               6210
Case Was Rejected                                                                    81
Case Was Rejected Because I Did Not Sign My Form                                    836
Case Was Rejected Because It Was Improperly Filed                                  1291
Case Was Reopened                                                                    11
Case Was Reopened For Reconsideration                                                 1
Case Was Sent To The Department of State                                          10569
Case Was Transferred And A New Office Has Jurisdiction                            14926
Case Was Transferred To An Asylum Office                                              1
Case Was Transferred To Schedule An Interview                                         1
Correspondence Was Received And USCIS Is Reviewing It                               133
Date of Birth Was Updated                                                           236
Decision Notice Mailed                                                              169
Document Was Mailed To Me                                                             2
Duplicate Notice Was Mailed                                                          15
Fee Refund Was Mailed                                                                 2
Fee Was Not Corrected                                                                 1
Fee Will Be Refunded                                                                  2
Fees Were Waived                                                                    249
Fingerprint Fee Has Issues That Need To Be Fixed                                      8
Fingerprint Fee Was Received                                                        577
Name Was Updated                                                                   1245
New Card Is Being Produced                                                         1862
Notice Explaining USCIS&apos; Actions Was Mailed                                         179
Notice Was Returned To USCIS Because The Post Office Could Not Deliver It           365
Payment Fee Was Returned For Insufficient Funds                                      41
Receipt Notice Was Changed                                                           58
Request for Additional Evidence Was Mailed                                          861
Request for Initial Evidence Was Mailed                                            3262
Response To USCIS&apos; Request For Evidence Was Received                                940
Withdrawal Acknowledgement Notice Was Sent                                           24
Name: receipt, dtype: int64
</code></pre><p>I ignore most of the corner cases and only look at a few larger categories:</p>
<ul>
<li>If the word <code>I-765</code> appears in the <code>text</code> of a case (since we are only looking at OPT cases), and <code>Case Was Received</code> is in the <code>title</code>, then the case is still processing. This happens when USCIS receives the case. Most people enduring the long 60 to 90 day wait will see this.</li>
<li>If the word <code>I-765</code> appears in the <code>text</code> of a case, and <code>Case Was Transferred</code> is in the <code>title</code>, then the case was probably submitted to the Vermont office first then routed to the Potomac office. This is still <code>processing</code> as well.</li>
<li>If the word <code>I-765</code> appears in the <code>text</code> of a case, and <code>Case Was Rejected</code>, well sucks for you. The case is rejected.</li>
<li>If the word <code>I-765</code> appears in the <code>text</code> of a case and <code>Case Was Approved</code>, congratulations! Your case is approved.</li>
<li>Even better, if a card is made and being delieverd, you’d have the <code>Card Was Delivered To Me By The Post Office</code> in the <code>title</code> of the case.</li>
</ul>
<p>I make a silly function for this and iterate over each row of the dataframe.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_status</span><span class="params">(row)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'I-765'</span> <span class="keyword">in</span> row[<span class="string">'text'</span>] <span class="keyword">and</span> <span class="string">'Case Was Received'</span> <span class="keyword">in</span> row[<span class="string">'title'</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'processing'</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'I-765'</span> <span class="keyword">in</span> row[<span class="string">'text'</span>] <span class="keyword">and</span> <span class="string">'Case Was Transferred'</span> <span class="keyword">in</span> row[<span class="string">'title'</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'processing'</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'I-765'</span> <span class="keyword">in</span> row[<span class="string">'text'</span>] <span class="keyword">and</span> <span class="string">'Case Was Rejected'</span> <span class="keyword">in</span> row[<span class="string">'title'</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'rejected'</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'I-765'</span> <span class="keyword">in</span> row[<span class="string">'text'</span>] <span class="keyword">and</span> <span class="string">'Case Was Approved'</span> <span class="keyword">in</span> row[<span class="string">'title'</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'approved'</span></span><br><span class="line">    <span class="keyword">if</span> row[<span class="string">'title'</span>] == <span class="string">'Card Was Delivered To Me By The Post Office'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'approved'</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line"></span><br><span class="line">data[<span class="string">'status'</span>] = data.apply(gen_status, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>Now here’s a slightly harder part. Only in the <code>Case Was Received</code> cases do we have a <strong>submission date</strong> for the OPT application. For the others (approved or rejected) the case status <code>text</code> only contains the date that the case was approved (which I am really not interested in for now). I want to know when those cases are <strong>submitted</strong>. Fortunately, I can again exploit the fact that the numbers are in increasing order. When the date of a case cannot be determined, I simply look backwards (to earlier receipt numbers) to the last known date of a still processing case. This gives me a good approximation of the submission dates of approved / rejected cases.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line">pattern = re.compile(<span class="string">'On ([A-z]+ [0-9]+, [0-9]+),'</span>)</span><br><span class="line"></span><br><span class="line">last_date = <span class="keyword">None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extract_date</span><span class="params">(row)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> row[<span class="string">'status'</span>] == <span class="string">'processing'</span>:</span><br><span class="line">        m = pattern.search(row[<span class="string">'text'</span>])</span><br><span class="line">        <span class="keyword">global</span> last_date</span><br><span class="line">        last_date = numpy.datetime64(pandas.Timestamp(m.group(<span class="number">1</span>)))</span><br><span class="line">        <span class="keyword">return</span> last_date</span><br><span class="line">    <span class="keyword">return</span> last_date</span><br><span class="line"></span><br><span class="line">data[<span class="string">'date'</span>] = data.apply(extract_date, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h1 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h1><p>Now I can look at the results. First, I group the data by the <code>date</code> column. Cases (rows) with the same date will be grouped together. Then, for each date, I count the number of <code>processing</code>, <code>approved</code>, and <code>rejected</code> cases.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">result = pandas.DataFrame(data[data[<span class="string">'status'</span>] == <span class="string">'processing'</span>].groupby(<span class="string">'date'</span>)[<span class="string">'receipt'</span>].count())</span><br><span class="line">result[<span class="string">'approved'</span>] = data[data[<span class="string">'status'</span>] == <span class="string">'approved'</span>].groupby(<span class="string">'date'</span>)[<span class="string">'receipt'</span>].count()</span><br><span class="line">result[<span class="string">'rejected'</span>] = data[data[<span class="string">'status'</span>] == <span class="string">'rejected'</span>].groupby(<span class="string">'date'</span>)[<span class="string">'receipt'</span>].count()</span><br><span class="line">result.columns = [<span class="string">'Processing'</span>, <span class="string">'Approved'</span>, <span class="string">'Rejected'</span>]</span><br></pre></td></tr></table></figure>
<p>And I make a silly plot.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result.plot()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x111202358&gt;
</code></pre><p><img src="/images/OPT-I-765-Processing-Time/output_17_1.svg" alt="svg"></p>
<p>Here’s how to interpret this data. I can see that most of the cases submitted in February and early March are already processed. The ones submitted in later March are around 50% processed. The ones submitted in late March (like mine) are beginning to get approved.</p>
<p>For each date, I can see the number of cases approved, rejected, processing etc.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result.loc[<span class="string">'2016-03-30'</span>]</span><br></pre></td></tr></table></figure>
<pre><code>Processing    2069.0
Approved       328.0
Rejected         5.0
Name: 2016-03-30 00:00:00, dtype: float64
</code></pre><p>I can make this more readable by dividing the number of approved cases by the total number of processing, approved, and rejected cases.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result[<span class="string">'Total'</span>] = result[<span class="string">'Processing'</span>] + result[<span class="string">'Approved'</span>] + result[<span class="string">'Rejected'</span>]</span><br><span class="line">result[<span class="string">'Approved Proportion'</span>] = result[<span class="string">'Approved'</span>] / result[<span class="string">'Total'</span>]</span><br><span class="line">result[<span class="string">'Approved Proportion'</span>].plot()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11131ee10&gt;
</code></pre><p><img src="/images/OPT-I-765-Processing-Time/output_21_1.svg" alt="svg"></p>
<p>I really don’t understand why USCIS would not release this data (since it will help calm the nerves of so many international students). I do hope that this will help calm your nerves though as it did calm mine.</p>

    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Linan Qiu</h4>
    <p>A panda that eats bamboo and bashes keyboards.</p>
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://linanqiu.github.io/2016/05/24/OPT-I-765-Processing-Time/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://linanqiu.github.io/2016/05/24/OPT-I-765-Processing-Time/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://linanqiu.github.io/2016/05/24/OPT-I-765-Processing-Time/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>
    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/2016/06/09/Crude-Oil-Inventory-and-Intraday-Oil-Price-Movements/">
        ← Crude Oil Inventory and Intraday Oil Price Movements
    </a>
    
    <span class="page-number">•</span>
    
    <a class="older-posts" href="/2016/04/22/Running-Word-Embedding-on-Piazza-Posts/">
        Running Word Embedding on Piazza Posts →
    </a>
    
</nav>
  <div id="comment" class="comments-area">
    <h1 class="title"><a href="#disqus_comments" name="disqus_comments">Comments</a></h1>

    
</div>
</main>


  
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Pandamonium</a> &copy; 2016 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>


<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-66827435-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>





</body>
</html>
